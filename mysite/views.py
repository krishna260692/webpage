from django.views.generic import TemplateView
from django.core.mail import send_mail, BadHeaderError ,EmailMultiAlternatives
from django.shortcuts import render
from django.conf import settings
from . import forms
from website.settings import EMAIL_HOST_USER
from django.core.mail import send_mass_mail
from django.http import HttpResponse, HttpResponseRedirect
from django.core.mail import EmailMessage






def contactus(request):
    if request.method == 'POST':
        name = request.POST['fname']
        toemail = request.POST['emailid']
        mycontact = request.POST['contact']
        message = request.POST['mycomment']

        subject="this is auto generated mail do not reply to this mail"
        from_email=settings.EMAIL_HOST_USER

        msg=f"<h1>Please find below details of {name}</h1>" \
            f"<h1><b> Name </b>: { name} </h1>" \
            f"<h1><b>Email_id</b>: { toemail} </h1>" \
            f"<h1><b>Contact_No</b>: { mycontact} </h1>" \
            f"<h1><b>Message</b>: { message} </h1>"

        to='krishna260692@gmail.com'
        msg = EmailMultiAlternatives(subject, msg, from_email, [to])
        msg.content_subtype='html'
        msg.send()

        send_mail(
            "autogenerated mail do not reply",
            'your message has been successfully sent, we will contact you soon',
            from_email,
            [toemail],
            fail_silently=False,)
        return render(request, 'success.html')
    return render(request, 'contactus.html')


def homecontact(request):
    if request.method == 'POST':
        fname = request.POST['fname']
        lname = request.POST['lname']
        mycontact = request.POST['mycontact']
        toemail = request.POST['mymail']
        message = request.POST['comment']
        subject = "this is auto generated mail do not reply to this mail"
        from_email = settings.EMAIL_HOST_USER

        msg = f"<h1>Please find below details of {fname}</h1>" \
              f"<h1><b> Name </b>: {fname} </h1>" \
              f"<h1><b> Name </b>: {lname} </h1>" \
              f"<h1><b>Contact_no</b>: {mycontact} </h1>" \
              f"<h1><b>E-mail</b>: {toemail} </h1>" \
              f"<h1><b>Message</b>: {message} </h1>"

        to = 'krishna260692@gmail.com'
        msg = EmailMultiAlternatives(subject, msg, from_email, [to])
        msg.content_subtype = 'html'
        msg.send()

        send_mail(
            "autogenerated mail do not reply",
            'your message has been successfully sent, we will contact you soon',
            from_email,
            [toemail],
            fail_silently=False,
        )
        return render(request, 'success.html')



class about(TemplateView):
    template_name = "about.html"













